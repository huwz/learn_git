.. _git_add:

git add
=======

git 术语(items)
---------------

+------------------+---------------+------------------+
| 英文术语         | 名称          | 描述             |
+==================+===============+==================+
| ``tree``         | 树状结构      | ``----``         |
+------------------+---------------+------------------+
| ``working tree`` | 工作区        | git 工作目录     |
+------------------+---------------+------------------+
| ``index tree``   | 索引区/暂存区 | git 索引树       |
+------------------+---------------+------------------+
| ``HEAD``         | 头指针        | 版本号或者分支名 |
+------------------+---------------+------------------+

.. note:: 每次提交版本时，git 会根据工作区的文件内容生成版本快照，
          以树结构存储于索引文件 index 中。
          每个版本快照会对应一个唯一的 64 哈希值，标示版本号。

指令简介
--------

用工作区中的文件内容更新索引区，为下次提交做准备。
典型的应用是将当前目录整个提交到索引区，但也可以提交部分内容，或者删除工作区中不存在的文件。
索引区保存了工作区的内容快照，作为下一次提交的内容。
因此，任何对工作区的修改，提交前必须先使用 ``git add`` 指令保存到索引区中。
在提交动作执行之前，该指令可以执行多次。
而且指令只添加当前时刻指定的文件内容；
若想在提交前将随后的修改添加进来，必须再一次执行 ``git add``。

可以借助 ``git status`` 指令获取文件修改状态的简要信息；
包括已经保存到索引区的修改，未提交到索引区的修改，新增的文件列表和删除的文件列表等信息。

默认情况下，``git add`` 指令不会添加被忽略的文件。
如果显式指明了忽略的文件，则执行 ``git add <ignored files>`` 失败。
利用 Git 进行目录递归或者文件匹配时，会自动跳过被忽略的文件。
如果想要强制添加忽略文件，可以使用 ``git add -f``。

如何忽略文件呢？添加到 ``.gitignore`` 文件中即可。
该文件支持通配符和文件目录。

.. note:: 在 Windows 中不能直接用 GUI 建 .gitignore 文件 - -!。
 可以打开 git 命令窗口，利用 ``vim .gitignore`` 创建。

常用示例
--------

1. **git add <files/dir>**
2. **git -n <files/dir>** 文件是否存在，是否被忽略；目录中的文件是否被忽略
3. **git add -f <files/dir>**
4. **git add --ignore-removal <files/dir>**
